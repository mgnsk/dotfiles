---
options:
  cache:
    default:
      command: echo "$HOME/.cache"
usage: Install AUR packages.
run:
  - when:
      - exists: ${cache}/yay-bin
    command: git -C ${cache}/yay-bin pull

  - when:
      - not-exists: ${cache}/yay-bin
    command: git clone https://aur.archlinux.org/yay-bin.git ${cache}/yay-bin

  - command:
      dir: ${cache}/yay-bin
      exec: makepkg --noconfirm --needed --syncdeps --install --clean

  - command: yay -Y --devel --save

  # gpg: key 51C67305FFC2E5C0: public key "PHPStan Bot <ondrej+phpstanbot@mirtes.cz>"
  - command: gpg --keyserver keys.openpgp.org --recv-keys CA7C2C7A30C8E8E1274A847651C67305FFC2E5C0

  - command: >
      yay -S --noconfirm --batchinstall --removemake --cleanafter
      fish-fzf
      hadolint-bin
      shellcheck-bin
      lscolors-git
      phpactor
      phpstan-bin
