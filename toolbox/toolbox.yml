---
apiVersion: v1
kind: Pod
metadata:
  name: toolbox
spec:
  hostNetwork: true
  containers:
    - image: toolbox:latest
      name: toolbox
      env:
        - name: TERM
          value: ${TERM}
      securityContext:
        allowPrivilegeEscalation: false
        privileged: false
      tty: true
      stdin: true
      workingDir: /workspaces
      volumeMounts:
        - name: toolbox-workspaces
          mountPath: /workspaces:Z

        - name: toolbox-cargo-data
          mountPath: "${HOME}/.cargo"

        - name: toolbox-go-data
          mountPath: "${HOME}/go"

        - name: toolbox-state
          mountPath: "${HOME}/.local/state"

        - name: toolbox-cache
          mountPath: "${HOME}/.cache"

        - name: toolbox-tmp
          mountPath: /tmp

  restartPolicy: Never
  volumes:
    - name: toolbox-workspaces
      hostPath:
        path: "${HOME}/toolbox/workspaces"
        type: Directory

    - name: toolbox-cargo-data
      persistentVolumeClaim:
        claimName: toolbox-cargo-data

    - name: toolbox-go-data
      persistentVolumeClaim:
        claimName: toolbox-go-data

    - name: toolbox-state
      emptyDir:
        medium: Memory

    - name: toolbox-cache
      emptyDir:
        medium: Memory

    - name: toolbox-tmp
      emptyDir:
        medium: Memory
